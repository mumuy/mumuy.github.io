<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>测试</title>
        <link rel="stylesheet" href="https://www.daojishi321.com/static/www/style/dist/public/common.css?v=202206221530">
        <link rel="stylesheet" type="text/css" media="screen" href="https://www.daojishi321.com/static/www/style/dist/timer/index.css?v=202206221530" />
    </head>
    <body>
        <div class="wrapper">
        <div class="container">
        <div class="inner">
        <div class="module mod-panel">
        <div class="hd"><h1 class="title">时间计算器</h1></div>
        <div class="bd">
        <div class="layout-column-1">
        <div class="panel" data-type="formNow">
        <div class="c-hd">
        <h3 class="title">距离此刻时间计算</h3>
        <p>通过参考时间和时间差推算某个时间点。</p>
        </div>
        <div class="c-bd">
        <div class="field-group">
        <div class="field-wrapper">
        <div class="field-title">参考时间</div>
        <div class="field-content">
        <input type="datetime-local" name="starttime" value="2025-01-01T12:00:00.000" step="1"/>
        </div>
        </div>
        </div>
        <div class="field-group">
        <button class="btn btn-small">计算</button>
        </div>
        </div>
        <div class="c-ft"></div>
        </div>
        </div>
        <div class="layout-column-2">
        <div class="panel" data-type="dateDistance">
        <div class="c-hd">
        <h3 class="title">日期间隔计算器</h3>
        <p>通过开始日期与结束日期，计算两个日期相差天数。</p>
        </div>
        <div class="c-bd">
        <div class="field-group">
        <div class="field-wrapper">
        <div class="field-title">开始日期</div>
        <div class="field-content">
        <input type="date" name="starttime" value="2025-01-01"/>
        </div>
        </div>
        <div class="field-wrapper">
        <div class="field-title">结束日期</div>
        <div class="field-content">
        <input type="date" name="endtime" value="2025-11-11"/>
        </div>
        </div>
        </div>
        <div class="field-group">
        <button class="btn btn-small">计算</button>
        </div>
        </div>
        <div class="c-ft"></div>
        </div>
        <div class="panel" data-type="timeDistance">
        <div class="c-hd">
        <h3 class="title">时间间隔计算器</h3>
        <p>通过开始时间与结束时间，计算两个时间点的时间差。</p>
        </div>
        <div class="c-bd">
        <div class="field-group">
        <div class="field-wrapper">
        <div class="field-title">开始时间</div>
        <div class="field-content">
        <input type="datetime-local" name="starttime" value="2025-01-01T12:00:00.000" step="1"/>
        </div>
        </div>
        <div class="field-wrapper">
        <div class="field-title">结束时间</div>
        <div class="field-content">
        <input type="datetime-local" name="endtime" value="2025-11-11T12:00:00.000" step="1"/>
        </div>
        </div>
        </div>
        <div class="field-group">
        <button class="btn btn-small">计算</button>
        </div>
        </div>
        <div class="c-ft"></div>
        </div>
        <div class="panel" data-type="endDate">
        <div class="c-hd">
        <h3 class="title">日期推算计算器</h3>
        <p>通过参考日期和日期差推算某个日期。</p>
        </div>
        <div class="c-bd">
        <div class="field-group">
        <div class="field-wrapper">
        <div class="field-title">参考日期</div>
        <div class="field-content">
        <input type="date" name="starttime" value="2025-01-01"/>
        </div>
        </div>
        <div class="field-wrapper">
        <div class="field-title">日期差</div>
        <div class="field-content">
        <input type="number" name="distance" value="1" step="1">
        <span>天</span>
        </div>
        </div>
        </div>
        <div class="field-group">
        <button class="btn btn-small">计算</button>
        </div>
        </div>
        <div class="c-ft"></div>
        </div>
        <div class="panel" data-type="endTime">
        <div class="c-hd">
        <h3 class="title">时间推算计算器</h3>
        <p>通过参考时间和时间差推算某个时间点。</p>
        </div>
        <div class="c-bd">
        <div class="field-group">
        <div class="field-wrapper">
        <div class="field-title">参考时间</div>
        <div class="field-content">
        <input type="datetime-local" name="starttime" value="2025-01-01T12:00:00.000" step="1"/>
        </div>
        </div>
        <div class="field-wrapper">
        <div class="field-title">时间差</div>
        <div class="field-content">
        <input type="number" name="distance" value="1" step="1">
        <select name="type">
        <option value="day">天</option>
        <option value="hour">小时</option>
        <option value="minute">分钟</option>
        <option value="second">秒</option>
        </select>
        </div>
        </div>
        </div>
        <div class="field-group">
        <button class="btn btn-small">计算</button>
        </div>
        </div>
        <div class="c-ft"></div>
        </div>
        </div>
        </div>
        </div>
        <script src="https://www.daojishi321.com/static/www/script/dist/lib/jquery.js"></script>
        <script src="https://passer-by.com/datex/dist/datex.min.js"></script>
        <script type="text/javascript">
            let $mod_panel = $('.mod-panel');

            // 距离此刻时间计算
            (function(){
                let $panel = $mod_panel.find('.panel[data-type="formNow"]');
                let $starttime = $panel.find('input[name="starttime"]');
                let $result = $panel.find('.c-ft');
                // 时间的距离
                let getDistantce = function(starttime){
                    let start_time = new Date(starttime);
                    let end_time = new Date();
                    let time = end_time.getTime()-start_time.getTime();
                    let isBefore = time>0;
                    time = Math.abs(time);
                    return {
                        'isBefore':isBefore,
                        'day':Math.floor(time/8.64e7),
                        'hour':Math.floor(time%8.64e7/3.6e6),
                        'minute':Math.floor(time%3.6e6/6e4),
                        'second':Math.floor(time%6e4/1e3)
                    };
                };
                // 格式化
                let format = function(starttime){
                    let data = getDistantce(starttime);
                    let text = data['isBefore']?'已经过去':'距离还有';
                    $result.html(`<div class="countdown">
                        <span>${text}</span>
                        <span class="time">${data['day'].toString().padStart(2,'0')}</span>天
                        <span class="time">${data['hour'].toString().padStart(2,'0')}</span>小时
                        <span class="time">${data['minute'].toString().padStart(2,'0')}</span>分钟
                        <span class="time">${data['second'].toString().padStart(2,'0')}</span>秒
                    </div>`);
                };
                let hander = null;
                $panel.on('click','button',function(){
                    let starttime = $starttime.val();
                    hander&&clearInterval(hander);
                    hander = setInterval(function(){
                        format(starttime);
                    },1000);
                    format(starttime);
                });
                // 初始化
                $starttime.val(datex().startOf('year').format('YYYY-MM-DDT12:00:00.000'));
            })();

            // 日期间隔计算器
            (function(){
                let $panel = $mod_panel.find('.panel[data-type="dateDistance"]');
                let $starttime = $panel.find('input[name="starttime"]');
                let $endtime = $panel.find('input[name="endtime"]');
                let $result = $panel.find('.c-ft');
                // 时间的距离
                let getDistantce = function(starttime,endtime){
                    let start_time = new Date(starttime);
                    let end_time = new Date(endtime);
                    let time = end_time.getTime()-start_time.getTime();
                    let isBefore = time>0;
                    time = Math.abs(time);
                    return {
                        'isBefore':isBefore,
                        'day':Math.floor(time/8.64e7),
                        'hour':Math.floor(time%8.64e7/3.6e6),
                        'minute':Math.floor(time%3.6e6/6e4),
                        'second':Math.floor(time%6e4/1e3)
                    };
                };
                // 格式化
                let format = function(starttime,endtime){
                    let data = getDistantce(starttime,endtime);
                    let text = data['isBefore']?'相差':'相差';
                    $result.html(`<div class="countdown">
                        <span>${text}</span>
                        ${data['day']?`<span class="time">${data['day'].toString().padStart(2,'0')}</span>天`:``}
                        ${data['hour']?`<span class="time">${data['hour'].toString().padStart(2,'0')}</span>小时`:``}
                        ${data['minute']?`<span class="time">${data['minute'].toString().padStart(2,'0')}</span>分钟`:``}
                        ${data['second']?`<span class="time">${data['second'].toString().padStart(2,'0')}</span>秒`:``}
                    </div>`);
                };
                $panel.on('click','button',function(){
                    let starttime = $starttime.val().replace(/\-/g,'/');
                    let endtime = $endtime.val().replace(/\-/g,'/');
                    format(starttime,endtime);
                });
                // 初始化
                $starttime.val(datex().startOf('year').format('YYYY-MM-DD'));
                $endtime.val(datex().startOf('day').format('YYYY-MM-DD'));
            })();

            // 时间间隔计算器
            (function(){
                let $panel = $mod_panel.find('.panel[data-type="timeDistance"]');
                let $starttime = $panel.find('input[name="starttime"]');
                let $endtime = $panel.find('input[name="endtime"]');
                let $result = $panel.find('.c-ft');
                // 时间的距离
                let getDistantce = function(starttime,endtime){
                    let start_time = new Date(starttime);
                    let end_time = new Date(endtime);
                    let time = end_time.getTime()-start_time.getTime();
                    let isBefore = time>0;
                    time = Math.abs(time);
                    return {
                        'isBefore':isBefore,
                        'day':Math.floor(time/8.64e7),
                        'hour':Math.floor(time%8.64e7/3.6e6),
                        'minute':Math.floor(time%3.6e6/6e4),
                        'second':Math.floor(time%6e4/1e3)
                    };
                };
                // 格式化
                let format = function(starttime,endtime){
                    let data = getDistantce(starttime,endtime);
                    let text = data['isBefore']?'相差':'相差';
                    $result.html(`<div class="countdown">
                        <span>${text}</span>
                        ${data['day']?`<span class="time">${data['day'].toString().padStart(2,'0')}</span>天`:``}
                        ${data['hour']?`<span class="time">${data['hour'].toString().padStart(2,'0')}</span>小时`:``}
                        ${data['minute']?`<span class="time">${data['minute'].toString().padStart(2,'0')}</span>分钟`:``}
                        ${data['second']?`<span class="time">${data['second'].toString().padStart(2,'0')}</span>秒`:``}
                    </div>`);
                };
                $panel.on('click','button',function(){
                    let starttime = $starttime.val();
                    let endtime = $endtime.val();
                    format(starttime,endtime);
                });
                $starttime.val(datex().startOf('year').format('YYYY-MM-DDT12:00:00.000'));
                $endtime.val(datex().startOf('day').format('YYYY-MM-DDT12:00:00.000'));
            })();

            // 日期推算计算器
            (function(){
                let $panel = $mod_panel.find('.panel[data-type="endDate"]');
                let $starttime = $panel.find('input[name="starttime"]');
                let $distance = $panel.find('input[name="distance"]');
                let $result = $panel.find('.c-ft');
                // 时间的距离
                let getTime = function(starttime,distance){
                    let start_time = new Date(starttime);
                    let time = start_time.getTime()+distance;
                    return datex(time).format('YYYY年MM月DD日');
                };
                // 格式化
                let format = function(starttime,distance){
                    let timeStr = getTime(starttime,distance);
                    $result.html(`<div class="countdown">
                        <span>推算日期</span>
                        <span class="time">${timeStr}</span>
                    </div>`);
                };
                $panel.on('click','button',function(){
                    let starttime = $starttime.val();
                    let distance = $distance.val();
                    let period = 86400000;
                    format(starttime,distance*period);
                });
                // 初始化
                $starttime.val(datex().startOf('year').format('YYYY-MM-DD'));
            })();

            // 时间推算计算器
            (function(){
                let $panel = $mod_panel.find('.panel[data-type="endTime"]');
                let $starttime = $panel.find('input[name="starttime"]');
                let $distance = $panel.find('input[name="distance"]');
                let $type = $panel.find('select[name="type"]');
                let $result = $panel.find('.c-ft');
                // 时间的距离
                let getTime = function(starttime,distance){
                    let start_time = new Date(starttime);
                    let time = start_time.getTime()+distance;
                    return datex(time).format('YYYY年MM月DD日 HH:mm:ss');
                };
                // 格式化
                let format = function(starttime,distance){
                    let timeStr = getTime(starttime,distance);
                    $result.html(`<div class="countdown">
                        <span>推算时间</span>
                        <span class="time">${timeStr}</span>
                    </div>`);
                };
                $panel.on('click','button',function(){
                    let starttime = $starttime.val();
                    let distance = $distance.val();
                    let type = $type.val();
                    let periodMap = {
                        day:86400000,
                        hour:3600000,
                        minute:60000,
                        second:1000
                    };
                    format(starttime,distance*periodMap[type]);
                });
                // 初始化
                $starttime.val(datex().startOf('year').format('YYYY-MM-DDT12:00:00.000'));
            })();
        </script>
    </body>
</html>